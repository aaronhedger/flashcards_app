<!-- cards/existing_classeur/classeur_sujet/voc_all1.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flashcards</title>
    <style>
        /* Flashcard styling */
        .flashcard {
            width: 300px;
            height: 400px;
            perspective: 1000px; /* This ensures that 3D transforms like flipping are visible */
            margin: 0 auto;
            position: relative;
        }

        .flashcard-inner {
            width: 100%;
            height: 100%;
            position: relative;
            transition: transform 0.8s;
            transform-style: preserve-3d; /* Preserve 3D effects */
        }

        .flashcard.flipped .flashcard-inner {
            transform: rotateY(180deg); /* Flip the card on Y-axis when 'flipped' class is added */
        }

        .flashcard-front, .flashcard-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden; /* Hide the back of the card when flipped */
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 20px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            border-radius: 10px;
        }

        .flashcard-front {
            background-color: #5f80ec; /* Front side color */
        }

        .flashcard-back {
            background-color: #af2222; /* Back side color */
            transform: rotateY(180deg); /* Start with the back side flipped */
        }

        .buttons {
            text-align: center;
            margin-top: 20px;
        }

        .buttons button {
            padding: 10px 20px;
            margin: 10px;
            font-size: 16px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <audio id="clickSound">
        <source src="{{ audio_file_path }}" type="audio/mpeg">
        Your browser does not support the audio element.
    </audio>

    <div class="container">
        <h1>Flashcards</h1>

        <!-- Flashcard display area -->
        <div class="flashcard" id="flashcard" onclick="flipCard()">
            <div class="flashcard-inner">
                <div class="flashcard-front">
                    <h2 class="title" id="flashcardTitle"></h2>
                    <p id="flashcardFrontContent"></p>
                </div>
                <div class="flashcard-back">
                    <h2 class="title" id="flashcardTitleBack"></h2>
                    <p id="flashcardBackContent"></p>
                </div>
            </div>
        </div>

        <!-- Buttons for user actions -->
        <div class="buttons">
            <button onclick="categorizeCard('notLearned')">Pas Appris</button>
            <button onclick="categorizeCard('learned')">Appris</button>
        </div>
    </div>

    <!-- JSON serialization of card data -->
    <script id="cardData" type="application/json">
        {{ card_data|json_script:"cardData" }}
    </script>

    <script>
        // Parse card data safely from Django template using JSON script
        const cardData = JSON.parse(document.getElementById('cardData').textContent);

        // Arrays to store categorized cards
        const learnedCards = [];
        const notLearnedCards = [];

        let currentCardIndex = 0;
        let isFlipped = false;

        // Function to display a card based on the current index
        function displayCard(index) {
            if (index >= cardData.length) {
                document.getElementById('flashcard').style.display = 'none'; // Hide flashcards when no more left
                alert('All cards are categorized!');
                return;
            }

            // Reset flip state for the new card
            isFlipped = false;
            document.getElementById('flashcard').classList.remove('flipped');

            // Get current card data
            const card = cardData[index];
            document.getElementById('flashcardTitle').textContent = card.title;
            document.getElementById('flashcardFrontContent').innerHTML = card.front_content;
            document.getElementById('flashcardTitleBack').textContent = card.title;
            document.getElementById('flashcardBackContent').innerHTML = card.back_content;
        }

        // Function to flip the card
        function flipCard() {
            const flashcard = document.getElementById('flashcard');
            flashcard.classList.toggle('flipped'); // Toggle the 'flipped' class
            isFlipped = !isFlipped;
        }

        // Function to categorize the card and go to the next one
        function categorizeCard(category) {
            const currentCard = cardData[currentCardIndex];

            if (category === 'learned') {
                learnedCards.push(currentCard);
            } else {
                notLearnedCards.push(currentCard);
            }

            // Play click sound
            var clickSound = document.getElementById('clickSound');
            clickSound.play();

            // Move to the next card
            currentCardIndex++;
            displayCard(currentCardIndex);
        }

        // Initialize the first card on page load
        displayCard(currentCardIndex);
    </script>
</body>
</html>
